const fs=require("fs"),path=require("path"),https=require("https"),http=require("http"),gamesData=JSON.parse(fs.readFileSync("games.json","utf8")),imagesDir=path.join(__dirname,"..","public","images");function downloadImage(url,filepath){return new Promise(((resolve,reject)=>{const protocol=url.startsWith("https")?https:http,file=fs.createWriteStream(filepath);protocol.get(url,(response=>{200===response.statusCode?(response.pipe(file),file.on("finish",(()=>{file.close(),resolve()}))):(fs.unlink(filepath,(()=>{})),reject(new Error(`Failed to download: ${response.statusCode}`)))})).on("error",(err=>{fs.unlink(filepath,(()=>{})),reject(err)}))}))}function generateSlug(name){return name.toLowerCase().replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-")}async function downloadLogos(){console.log("Starting logo download...\n");const results={success:[],failed:[],skipped:[]};for(const game of gamesData){const slug=generateSlug(game.name),logoUrl=game.logo;if(logoUrl.startsWith("/images/")){console.log(`‚è≠Ô∏è  Skipping ${game.name} - already has local path`),results.skipped.push({name:game.name,reason:"Local path exists"});continue}console.log(`\nüì• Processing: ${game.name}`),console.log(`   URL: ${logoUrl}`);const outputPath=path.join(imagesDir,`${slug}.webp`);try{console.log("   Downloading..."),await downloadImage(logoUrl,outputPath),game.logo=`/images/${slug}.webp`,console.log(`   ‚úÖ Success: ${slug}.webp`),results.success.push({name:game.name,file:`${slug}.webp`})}catch(error){console.error(`   ‚ùå Failed: ${error.message}`),results.failed.push({name:game.name,error:error.message})}}fs.writeFileSync("games.json",JSON.stringify(gamesData,null,2)),console.log("\n‚úÖ Updated games.json with new logo paths"),console.log("\n"+"=".repeat(60)),console.log("SUMMARY"),console.log("=".repeat(60)),console.log(`‚úÖ Success: ${results.success.length}`),console.log(`‚ùå Failed: ${results.failed.length}`),console.log(`‚è≠Ô∏è  Skipped: ${results.skipped.length}`),console.log("=".repeat(60)),results.failed.length>0&&(console.log("\nFailed downloads:"),results.failed.forEach((item=>{console.log(`  - ${item.name}: ${item.error}`)}))),results.skipped.length>0&&(console.log("\nSkipped (already have local paths):"),results.skipped.forEach((item=>{console.log(`  - ${item.name}`)}))),console.log("\n‚ö†Ô∏è  Note: Images are downloaded in original format."),console.log("   To convert to WebP 512x512, run:"),console.log("   npm run convert-logos")}fs.existsSync(imagesDir)||fs.mkdirSync(imagesDir,{recursive:!0}),downloadLogos().catch(console.error);